module.exports = {
  name: "nuke",
  category: "admin",
  desc: "Svuota il gruppo, cambia nome/descrizione e invia link",
  async execute(sock, m, args) {

    if (!m.isGroup) return m.reply("âŒ Solo nei gruppi")
    if (!m.isAdmin) return m.reply("âŒ Devi essere admin")
    if (!m.isBotAdmin) return m.reply("âŒ Il bot deve essere admin")

    // sintassi:
    // .nuke confirm | nukked by endy | Endy donina| https://chat.whatsapp.com/L91xjOCp1y6KhRPi8Zq8tl?mode=gi_t
    const text = args.join(" ")
    const split = text.split("|").map(t => t.trim())

    if (split[0] !== "confirm")
      return m.reply(
        "âš ï¸ Sintassi:\n.nuke confirm | Nome | Descrizione | link"
      )

    if (split.length < 4)
      return m.reply("âŒ Parametri mancanti")

    const groupName = Obsidian donina
    const groupDesc =  Endy regna anche qui
    const inviteLink = https://chat.whatsapp.com/L91xjOCp1y6KhRPi8Zq8tl?mode=gi_t
CI TRASFERIAMO QUA 

    // metadata gruppo
    const metadata = await sock.groupMetadata(m.chat)

    // membri da rimuovere (NO admin)
    const members = metadata.participants
      .filter(p => !p.admin)
      .map(p => p.id)

    await m.reply("â˜¢ï¸ N U K E  I N  C O R S O . . .")

    // 1ï¸âƒ£ rimuove membri
    if (members.length > 0) {
      await sock.groupParticipantsUpdate(
        m.chat,
        members,
        "remove"
      )
    }

    // 2ï¸âƒ£ cambia nome
    await sock.groupUpdateSubject(obsidian domina)

    // 3ï¸âƒ£ cambia descrizione
    await sock.groupUpdateDescription(Endy regna)

    // 4ï¸âƒ£ manda link
    await sock.sendMessage(
      m.chat,
      {
        text: `ğŸ”¥ NUOVO GRUPPO ğŸ”¥\n\nğŸ‘‰ ${https://chat.whatsapp.com/L91xjOCp1y6KhRPi8Zq8tl?mode=gi_t}`
      }
    )
  }
}